{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{398:function(o,c,e){\"use strict\";e.r(c);var v=e(25),_=Object(v.a)({},(function(){var o=this,c=o.$createElement,e=o._self._c||c;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":o.$parent.slotKey}},[e(\"p\",[o._v(\"几经折腾，本站终于实现https加密了。下面将分享我是如何实现https全站加密的。\")]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"首先需要申请一个SSL证书，我的SSL证书是在阿里云免费申请的。\")])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"申请好证书后，接下来就是如何安装SSL证书和如何在Nginx服务器端进行配置。\")])]),o._v(\" \"),e(\"p\",[o._v(\"一、将申请的证书文件上传到服务器\")]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"使用Xshell连接到远程服务器，在 \"),e(\"code\",[o._v(\"/usr/local/nginx/\")]),o._v(\" 目录下创建 \"),e(\"code\",[o._v(\"cert\")]),o._v(\" 文件夹\")])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"下载申请的ssl证书（一般包含两个文件，一个.pem和一个.key），上传至刚创建的 \"),e(\"code\",[o._v(\"cert\")]),o._v(\"文件夹内。\")])]),o._v(\" \"),e(\"p\",[o._v(\"二、配置\"),e(\"code\",[o._v(\"nginx.conf\")])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"首先在 \"),e(\"code\",[o._v(\"/usr/local/nginx/conf/\")]),o._v(\" 目录下找到 \"),e(\"code\",[o._v(\"nginx.conf\")]),o._v(\" 文件，\")])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"将 \"),e(\"code\",[o._v(\"listen 80;\")]),o._v(\" 改为 \"),e(\"code\",[o._v(\"listen 443;\")]),o._v(\" 其它 \"),e(\"code\",[o._v(\"server_name，index，root\")]),o._v(\" 等都不需要改动；\")])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"然后再在server段中添加以下代码：\")])]),o._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",[e(\"code\",[o._v(\"ssl on;\\nssl_certificate   /usr/local/nginx/cert/214036733780684.pem;\\nssl_certificate_key  /usr/local/nginx/cert/214036733780684.key;\\nssl_session_timeout 5m;\\nssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;\\nssl_protocols TLSv1 TLSv1.1 TLSv1.2;\\nssl_prefer_server_ciphers on;\\n\")])])]),e(\"blockquote\",[e(\"p\",[o._v(\"特别需要注意的是：\")])]),o._v(\" \"),e(\"ul\",[e(\"li\",[e(\"p\",[e(\"code\",[o._v(\"ssl_certificate\")]),o._v(\":这一行的路径一定需要填写正确，是绝对路径（以 / 开始），就是指具体在服务器的哪个位置；214036733780684.pem，这个文件名的一段数字就是指申请的ssl证书名，不能填写错误\")])]),o._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[o._v(\"ssl_certificate_key\")]),o._v(\" :同上。\")])]),o._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[o._v(\"ssl_session_timeout 5m\")]),o._v(\":不修改\")])]),o._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[o._v(\"ssl_ciphers\")]),o._v(\":改为自己的；\")])]),o._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[o._v(\"ssl_protocols TLSv1 TLSv1.1 TLSv1.2\")]),o._v(\":不需要改动\")])]),o._v(\" \"),e(\"li\",[e(\"p\",[e(\"code\",[o._v(\"ssl_prefer_server_ciphers on\")]),o._v(\":不需要改动。\")])])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"配置完后如下：\")])]),o._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:\"https://nico.cc/files/images/screenshots/ssl-nginx-conf.png\",alt:\"ssl-2\"}})]),o._v(\" \"),e(\"p\",[o._v(\"三、单个站点 \"),e(\"code\",[o._v(\"yourdomain.conf\")]),o._v(\" 文件的配置\")]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"在 \"),e(\"code\",[o._v(\"/usr/local/nginx/conf/vhost/\")]),o._v(\" 目录下找到需要配置的文件，比如 \"),e(\"code\",[o._v(\"www.conimi.com.conf\")])])]),o._v(\" \"),e(\"p\",[o._v(\"在server段只需修改 listen 端口为443即可;`\")]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"修改完成后，就可以通过\"),e(\"code\",[o._v(\"https://www.conimi.com\")]),o._v(\" 和 \"),e(\"code\",[o._v(\"https://conimi.com\")]),o._v(\" 访问了\")])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"进一步将\"),e(\"code\",[o._v(\"https://conimi.com\")]),o._v(\" 设置301重定向跳转至\"),e(\"code\",[o._v(\"https://www.conimi.com\")])])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"新建一个server段配置，\")])]),o._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",[e(\"code\",[o._v(\"server\\n{\\nlisten 443;\\nserver_name conimi.com;\\nrewrite ^(.*) https://www.conimi.com$1 permanent;\\n}\\n\")])])]),e(\"blockquote\",[e(\"p\",[o._v(\"就完成了  \"),e(\"code\",[o._v(\"https://conimi.com 301\")]),o._v(\"重定向至\"),e(\"code\",[o._v(\"https://www.conimi.com\")])])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"以下是配置好的 \"),e(\"code\",[o._v(\"https://conimi.com 301\")]),o._v(\"重定向至 \"),e(\"code\",[o._v(\"https://www.conimi.com\")]),o._v(\"，特别需要注意两个server段的 server_name。\")])]),o._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:\"https://nico.cc/files/images/screenshots/ssl-vhost-nginx-conf-f.png\",alt:\"ssl-3\"}})]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"至此，站点就完成了https全站加密，但是，我们很多时候会通过\"),e(\"code\",[o._v(\"http://www.conimi.com\")]),o._v(\"和\"),e(\"code\",[o._v(\"http://conimi.com\")]),o._v(\"访问，于是，我们还需要做一个301重定向，将\"),e(\"code\",[o._v(\"http://www.conimi.com\")]),o._v(\"和\"),e(\"code\",[o._v(\"http://conimi.com\")]),o._v(\"跳转至\"),e(\"code\",[o._v(\"https://www.conimi.com\")])])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"再新建一个server段，配置如下：\")])]),o._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",[e(\"code\",[o._v(\"server\\n{\\nlisten 80;\\nserver_name www.conimi.com conimi.com;\\nrewrite ^(.*) https://www.conimi.com$1 permanent;\\n}\\n\")])])]),e(\"blockquote\",[e(\"p\",[o._v(\"于是就完成了 \"),e(\"code\",[o._v(\"http://www.conimi.com\")]),o._v(\"和\"),e(\"code\",[o._v(\"http://conimi.com\")]),o._v(\" 跳转到 \"),e(\"code\",[o._v(\"https://www.conimi.com\")])])]),o._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:\"https://nico.cc/files/images/screenshots/ssl-vhost-nginx-conf-s.png\",alt:\"请输入图片描述\"}})]),o._v(\" \"),e(\"p\",[o._v(\"四、重启服务器。\")]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"完成以上配置后，重新启动服务器，我们就可以通过\"),e(\"code\",[o._v(\"http://www.conimi.com、http://conimi.com、https://conimi.com\")]),o._v(\"和\"),e(\"code\",[o._v(\"https://www.conimi.com\")]),o._v(\"访问了。\")])]),o._v(\" \"),e(\"p\",[o._v(\"五、可能会出现的问题：\")]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"能通过https访问，但是浏览器还是显示为不安全，这就需要检查你的网站的资源链接如图片路径，歌曲链接，头像链接等是否为https路径，如果不是，则需要改为https，否则依旧会显示不安全。\")])]),o._v(\" \"),e(\"blockquote\",[e(\"p\",[o._v(\"因此在以后添加图像资源等时，特别需要注意链接是否为https。\")])])])}),[],!1,null,null,null);c.default=_.exports}}]);","extractedComments":[]}